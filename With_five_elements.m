clear
clc
A1=570*10^(-6);A2=478.8*10^(-6);A3=465.5*10^(-6);A4=400*10^(-6); A5=375*10^(-6); t=2*10^(-3);
D=237.3*10^9*[1 0.27 0; 0.27 1 0; 0 0 0.539];
B1=1/(2*A1)*[-22.8 0 -27.2 0 50 0 ; 0 0 0 -50 0 50; 0 -22.8 -50 -27.2 50 50 ];
Bt1=1/(2*A1)*transpose(B1);
Ke1=A1*t*Bt1*(D*B1)
B2=1/(2*A2)*[3 0 -25.8 0 0 0;0 42 0 -42 0 0 ; 42 3 -42 -25.8 0 0];
Bt2=1/(2*A2)*transpose(B2);
Ke2=A2*t*Bt2*(D*B2);
B3=1/(2*A3)*[25 0 -22  0 -3 0; 0 25 0 17 0 -42; 25 25 17 -22 -42 -3];
Bt3=1/(2*A3)*transpose(B3);
Ke3=A3*t*Bt3*(D*B3);
B4=1/(2*A4)*[0 0 -40 0 40 0; 0 -20 0 50 0 -30; -20 0 50 -40 -30 40];
Bt4=1/(2*A4)*transpose(B4);
Ke4=A4*t*Bt4*(D*B4);
B5=1/(2*A5)*[-30 0 -47 0 77 0; 0 0 0 25 0 -25; 0 -30 25 -47 -25 77];
Bt5=1/(2*A5)*transpose(B5);
Ke5=A5*t*Bt5*(D*B5);
%1,2,4
Kg=zeros(18);
Kg(1:2,1:2)=Kg(1:2,1:2)+Ke1(1:2,1:2);
Kg(3:4,1:2)=Kg(3:4,1:2)+Ke1(3:4,1:2);
Kg(7:8,1:2)=Kg(7:8,1:2)+Ke1(5:6,1:2);
Kg(1:2,3:4)=Kg(1:2,3:4)+Ke1(1:2,3:4);
Kg(3:4,3:4)=Kg(3:4,3:4)+Ke1(3:4,3:4);
Kg(7:8,7:8)=Kg(7:8,7:8)+Ke1(5:6,5:6);
Kg(1:2,7:8)=Kg(1:2,7:8)+Ke1(1:2,5:6);
Kg(7:8,3:4)=Kg(7:8,3:4)+Ke1(5:6,3:4);
Kg(3:4,7:8)=Kg(3:4,7:8)+Ke1(3:4,5:6);
%2,3,4
Kg(3:4,3:4)=Kg(3:4,3:4)+Ke2(1:2,1:2);
Kg(5:6,3:4)=Kg(5:6,3:4)+Ke2(3:4,1:2);
Kg(7:8,3:4)=Kg(7:8,3:4)+Ke2(5:6,1:2);
Kg(3:4,5:6)=Kg(3:4,5:6)+Ke2(1:2,3:4);
Kg(5:6,5:6)=Kg(5:6,5:6)+Ke2(3:4,3:4);
Kg(7:8,7:8)=Kg(7:8,7:8)+Ke2(5:6,5:6);
Kg(3:4,7:8)=Kg(3:4,7:8)+Ke2(1:2,5:6);
Kg(5:6,7:8)=Kg(5:6,7:8)+Ke2(3:4,5:6);
Kg(7:8,5:6)=Kg(7:8,5:6)+Ke2(5:6,3:4);
%3,4,5
Kg(5:6,5:6)=Kg(5:6,5:6)+Ke3(1:2,1:2);
Kg(7:8,5:6)=Kg(7:8,5:6)+Ke3(3:4,1:2);
Kg(9:10,5:6)=Kg(9:10,5:6)+Ke3(5:6,1:2);
Kg(5:6,7:8)=Kg(5:6,7:8)+Ke3(1:2,3:4);
Kg(7:8,7:8)=Kg(7:8,7:8)+Ke3(3:4,3:4);
Kg(9:10,9:10)=Kg(9:10,9:10)+Ke3(5:6,5:6);
Kg(5:6,9:10)=Kg(5:6,9:10)+Ke3(1:2,5:6);
Kg(7:8,9:10)=Kg(7:8,9:10)+Ke3(3:4,5:6);
Kg(9:10,7:8)=Kg(9:10,7:8)+Ke3(5:6,3:4);
%4,8,9
Kg(7:8,7:8)=Kg(7:8,7:8)+Ke4(1:2,1:2);
Kg(15:16,7:8)=Kg(15:16,7:8)+Ke4(3:4,1:2);
Kg(17:18,7:8)=Kg(17:18,7:8)+Ke4(5:6,1:2);
Kg(7:8,15:16)=Kg(7:8,15:16)+Ke4(1:2,3:4);
Kg(15:16,15:16)=Kg(15:16,15:16)+Ke4(3:4,3:4);
Kg(17:18,17:18)=Kg(17:18,17:18)+Ke4(5:6,5:6);
Kg(7:8,17:18)=Kg(7:8,17:18)+Ke4(1:2,5:6);
Kg(15:16,17:18)=Kg(15:16,17:18)+Ke4(3:4,5:6);
Kg(17:18,15:16)=Kg(17:18,15:16)+Ke4(5:6,3:4);
%5,6,7
Kg(9:10,9:10)=Kg(9:10,9:10)+Ke5(1:2,1:2);
Kg(11:12,9:10)=Kg(11:12,9:10)+Ke5(3:4,1:2);
Kg(13:14,9:10)=Kg(13:14,9:10)+Ke5(5:6,1:2);
Kg(9:10,11:12)=Kg(9:10,11:12)+Ke5(1:2,3:4);
Kg(11:12,11:12)=Kg(11:12,11:12)+Ke5(3:4,3:4);
Kg(13:14,13:14)=Kg(13:14,13:14)+Ke5(5:6,5:6);
Kg(9:10,13:14)=Kg(9:10,13:14)+Ke5(1:2,5:6);
Kg(11:12,13:14)=Kg(11:12,13:14)+Ke5(3:4,5:6);
Kg(13:14,11:12)=Kg(13:14,11:12)+Ke5(5:6,3:4);
Kg
